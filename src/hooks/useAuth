import { useState, useEffect } from 'react';

export function useAuth() {
  const [user, setUser] = useState(() => {
    const saved = localStorage.getItem('user');
    return saved ? JSON.parse(saved) : null;
  });

  const [loading, setLoading] = useState(true);

  useEffect(() => {
    if (!user) {
      // fallback mock user（可選，要開發階段才加）
      const mockUser = {
        id: 'A0001',
        username: '王小明',
        department: '學生事務處',
        team: '學生事務處生活事務暨僑生輔導組',
      };
      localStorage.setItem('user', JSON.stringify(mockUser));
      setUser(mockUser);
    }
    setLoading(false);
  }, [user]);

  return { user, loading, isLoggedIn: !!user };
}
